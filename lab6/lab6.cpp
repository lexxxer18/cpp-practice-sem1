#include <iostream>
#include <stack>

using namespace std;

/**
 * –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏, –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –ª–∏ —á–∏—Å–ª–æ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏—Ö –∏ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö —Å–∫–æ–±–æ–∫
 * –≤ —Å—Ç—Ä–æ–∫–µ, –∫–æ—Ç–æ—Ä—É—é –≤–≤–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—É–¥–µ—Ç –ø—Ä–æ–π–¥–µ–Ω–∞, –µ—Å–ª–∏ –≤—Å–µ —Å–∫–æ–±–∫–∏
 * –∏–º–µ—é –∑–∞–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É –∏ —è–≤–ª—è—é—Ç—Å—è –ø–∞—Ä–Ω—ã–º–∏. –ù–∞–ø—Ä–∏–º–µ—Ä: {()<>}.
 * –°—Ç—Ä–æ–π–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É, –µ—Å–ª–∏ –∫–∞–∫–∞—è-–ª–∏–±–æ –æ—Ç–∫—Ä—ã–≤–∞—é—â–∞—è —Å–∫–æ–±–∫–∞ –Ω–µ –±—É–¥–µ—Ç –∏–º–µ—Ç—å
 * –∑–∞–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É, –ª–∏–±–æ –≥–¥–µ-—Ç–æ –±—É–¥–µ—Ç –Ω–µ –≤–µ—Ä–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–∫–æ–±–æ–∫. –ù–∞–ø—Ä–∏–º–µ—Ä: {[}]
 * –∏–ª–∏ [{].
 *
 * --------
 *
 * –ü—Ä–∏–º–µ—Ä –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ (–≤—ã–±–æ—Ä –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤):
 *
 * –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è:
 * 1 - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
 * 2 - –≤–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫—É —Å–∫–æ–±–æ–∫
 * 1
 * ‚ùå –°–∫–æ–±–∫–∏ –≤ *&NC)(N%^BW%Q)<}_)_C)WMW*ERGrh —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
 * ‚úÖ –°–∫–æ–±–∫–∏ –≤ UYU<N>K<{IuNuiS9}><>7((6!!!!23)){.}+!9n8c4t —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
 * ‚ùå –°–∫–æ–±–∫–∏ –≤ UYU<N>K<{IuNuiS9}><>7((6!!!!23)){.}]+!9n8c4t —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
 * ‚úÖ –°–∫–æ–±–∫–∏ –≤ This ({is}[<{some}>]) string! —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
 *
 * --------
 *
 * –ü—Ä–∏–º–µ—Ä –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞ (–≤—ã–±–æ—Ä –≤–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫—É):
 *
 * üõ†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è:
 * üëâ 1 - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
 * üëâ 2 - –≤–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫—É —Å–∫–æ–±–æ–∫
 * 2
 * –í–≤–µ–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É: –ª—ã–ª–∞–ø?()"‚Ññ;%%%%{<<<<>>>>}
 * ‚úÖ –°–∫–æ–±–∫–∏ –≤ –ª—ã–ª–∞–ø?()"‚Ññ;%%%%{<<<<>>>>} —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
 */

bool checkBracketsBalance(const string& str) {
    // —Å—Ç–µ–∫ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö —Å–∫–æ–±–æ–∫
    stack<char> bracketsStack;

    for (const char ch : str) {
        switch (ch) {
            // –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ–º –∫–∞–∫—É—é-–ª–∏–±–æ –æ—Ç–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É,
            // –¥–æ–±–∞–≤–∏–º –≤ —Å—Ç–µ–∫ –µ–µ –ø–∞—Ä–Ω—É—é –∑–∞–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É
            case '<':
                bracketsStack.push('>');
                break;
            case '{':
                bracketsStack.push('}');
                break;
            case '[':
                bracketsStack.push(']');
                break;
            case '(':
                bracketsStack.push(')');
                break;
            case '>':
            case '}':
            case ']':
            case ')':
                // –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ–º –∫–∞–∫—É—é-–ª–∏–±–æ –∑–∞–∫—Ä—ã–≤–∞—é—â—É—é —Å–∫–æ–±–∫—É,
                // —Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–Ω–∞ —Ç–æ–π, —á—Ç–æ –≤ —Å—Ç–µ–∫–µ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏—Ö —Å–∫–æ–±–æ–∫:
                // –µ—Å–ª–∏ —Å—Ç–µ–∫ –ø—É—Å—Ç–æ–π –∏–ª–∏ –≤–µ—Ä—Ö–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç —Å—Ç–µ–∫–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–∫—É—â–µ–π –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–π
                // —Å–∫–æ–±–∫–µ, —Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è false
                if (bracketsStack.empty() || bracketsStack.top() != ch) {
                    return false;
                }

                // –∞ –∏–Ω–∞—á–µ —É–¥–∞–ª—è–µ–º –≤–µ—Ä—Ö–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ —Å—Ç–µ–∫–∞
                bracketsStack.pop();
        }
    }

    // –µ—Å–ª–∏ —Å—Ç–µ–∫ –ø—É—Å—Ç, —Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º true, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ false
    return bracketsStack.empty();
}

void test(const string& str, int testNumber = 0) {
    if (checkBracketsBalance(str)) {
        cout << "‚úÖ –¢–µ—Å—Ç " << testNumber << ": –°–∫–æ–±–∫–∏ –≤ \"" << str << "\" —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ."
             << endl;
    } else {
        cout << "‚ùå –¢–µ—Å—Ç " << testNumber << ": –°–∫–æ–±–∫–∏ –≤ \"" << str << "\" —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ."
             << endl;
    }
}

int main() {
    cout << "‚ú®üíª –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∞–ª–∞–Ω—Å–∞ —Å–∫–æ–±–æ–∫ –≤ —Å—Ç—Ä–æ–∫–µ" << endl;
    cout << endl;

    int type;

    cout << "üõ†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è:" << endl;
    cout << "üëâ 1 - –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã" << endl;
    cout << "üëâ 2 - –≤–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Ä–∞—Å—Å—Ç–∞–Ω–æ–≤–∫—É —Å–∫–æ–±–æ–∫" << endl;
    cout << "–í–∞—à –≤—ã–±–æ—Ä: ";
    cin >> type;

    cin.ignore();
    cout << endl;

    if (type == 1) {
        cout << "\nüöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤...\n" << endl;

        const string test1 = "*&NC)(N%^BW%Q)<}_)_C)WMW*ERGrh";
        const string test2 = "UYU<N>K<{IuNuiS9}><>7((6!!!!23)){.}+!9n8c4t";
        const string test3 = "UYU<N>K<{IuNuiS9}><>7((6!!!!23)){.}]+!9n8c4t";
        const string test4 = "This ({is}[<{some}>]) string!";
        const string test5 = "";
        const string test6 = "No brackets here";

        test(test1, 1);
        test(test2, 2);
        test(test3, 3);
        test(test4, 4);
        test(test5, 5);
        test(test6, 6);

        cout << "\nüéâ –¢–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã." << endl;
    } else if (type == 2) {
        string input;
        cout << "üî§ –í–≤–µ–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É: ";
        getline(cin, input);

        test(input);
    } else {
        cout << "‚ùå –û—à–∏–±–∫–∞: –≤—ã–±—Ä–∞–Ω–æ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ." << endl;
    }

    return 0;
}
